kafka {
  bootstrap_servers = "kafka-cluster-kafka-bootstrap.kafka.svc.cluster.local:9092"
  batch_topic = "ecommerce.public.ecommerce_events"
  stream_topic = "ecommerce_streaming_events"
  group_id = "ecommerce_group"
  checkpoint_location = "/tmp/events_checkpoint"
  starting_offsets = "earliest"
}

minio {
  endpoint = "http://minio-hl.minio.svc.cluster.local:9000"
  access_key = "admin"
  secret_key = "password"
  bucket_name = "ecommerce"
  base_path = "ecommerce/events"
  file_format = "parquet"
  path_style_access = "true"
  connection_maximum = 15
  attempts_maximum = 3
  aws_region = "us-east-1"
  vacuum_retention_hours = 168
}

clickhouse {
  jdbc_url = "jdbc:clickhouse://chi-clickhouse-clickhouse-0-0.clickhouse.svc.cluster.local:8123/ecommerce"
  user = "admin"
  password = "password"
  database = "ecommerce"
  table = "ecommerce_events"
  batch_size = 5000
  max_connections = 10
  connection_timeout_ms = 30000
  socket_timeout_ms = 30000
}

spark {
  master = "local[*]"
  shuffle_partitions = 32
  timestamp_pattern = "yyyy-MM-dd HH:mm:ss"
  timezone = "UTC"
  watermark_duration = "5 minutes"
}

pipeline {
  batch_invalid_path = "batch/invalid"
  batch_dlq_path = "batch/dlq"
  batch_lineage_path = "lineage"
  batch_offset_path = "batch/offsets"
  streaming_invalid_path = "streaming/invalid"
  streaming_dlq_path = "streaming/dlq"
  streaming_lineage_path = "streaming/lineage"
  streaming_dedup_path = "streaming/deduplication"
  dlq_shutdown_wait_seconds = 5
  dedup_persistence_interval = 10
  dedup_key_columns = ["event_time", "user_id", "product_id", "event_type"]
}

validation {
  min_price = 0.01
  max_price = 1000000.0
  valid_event_types = ["view", "cart", "purchase", "remove_from_cart"]
}

deduplication {
  max_cache_size = 1000000
  load_history_hours = 24
  eviction_buffer = 1000
}

dlq {
  queue_size = 10000
  offer_timeout_seconds = 5
  poll_timeout_seconds = 1
}

ml {
  als{
    base_path = "ecommerce/ml/als"
    rank = 150,
    iter = 15,
    reg_param = 0.01
    alpha = 150.0
    evaluation_top_K = 10
    event_weights = {
      purchase = 100.0
      remove_from_cart = -10.0
      cart = 10.0
      view = 1.0
      view_cap = 50.0
    }
    block_factor = 2
  }
  classification {
    base_path = "ecommerce/ml/classification"
    weights = {
      purchase = 15.0
      remove_from_cart = 3.5
      cart = 7.0
      view = 1.0
    }
    trees = 128
    max_depth = 10
    min_instances_per_node = 25
    max_bins = 512
    subsampling_rate = 0.8
    feature_subset_strategy = "auto"
    use_top_n_bucketing = false
    top_n_categories = 500
  }
  time_decay_factor = 0.02
}

